#!/bin/sh

cat > test.in <<EOF
2 16 16
EOF

${MPIRUN} ./test.x < test.in > test.out

cat > test.out.ref <<EOF
#          Ideal          Result
# libtetrabz_occ
         0.25133E+01    0.25142E+01
         0.44429E+00    0.44363E+00

# libtetrabz_fermieng
         0.50000E+00    0.50001E+00
         0.25133E+01    0.25143E+01
         0.44429E+00    0.44369E+00

# libtetrabz_dos
         0.10053E+00    0.10734E+00
         0.80425E+00    0.82145E+00
         0.27143E+01    0.27056E+01
         0.64340E+01    0.64356E+01
         0.12566E+02    0.12533E+02
         0.00000E+00    0.00000E+00
         0.00000E+00    0.00000E+00
         0.00000E+00    0.00000E+00
         0.65827E+00    0.68276E+00
         0.44429E+01    0.44352E+01

# libtetrabz_intdos
         0.80425E-03    0.82841E-03
         0.25736E-01    0.25976E-01
         0.19543E+00    0.19585E+00
         0.82355E+00    0.82435E+00
         0.25133E+01    0.25142E+01
         0.00000E+00    0.00000E+00
         0.00000E+00    0.00000E+00
         0.00000E+00    0.00000E+00
         0.18431E-01    0.18434E-01
         0.44429E+00    0.44363E+00

# libtetrabz_dblstep
         0.48106E+00    0.48120E+00
         0.00000E+00    0.00000E+00
         0.12428E+00    0.12419E+00
         0.00000E+00    0.00000E+00

# libtetrabz_dbldelta
         0.62832E+01    0.62758E+01
         0.00000E+00    0.00000E+00
         0.31416E+01    0.31276E+01
         0.00000E+00    0.00000E+00

# libtetrabz_polstat
         0.38431E+01    0.38438E+01
         0.50265E+01    0.50283E+01
         0.10489E+01    0.10445E+01
         0.17772E+01    0.17745E+01

# libtetrabz_fermigr
         0.13963E+01    0.13965E+01
         0.15696E+01    0.15707E+01
         0.14726E+01    0.14696E+01
         0.00000E+00    0.00000E+00
         0.00000E+00    0.00000E+00
         0.00000E+00    0.00000E+00
         0.39262E+00    0.39179E+00
         0.34535E+00    0.34688E+00
         0.00000E+00    0.00000E+00
         0.00000E+00    0.00000E+00
         0.00000E+00    0.00000E+00
         0.00000E+00    0.00000E+00

# libtetrabz_polcmplx
        -0.83824E+00   -0.83669E+00
        -0.73420E+00   -0.73982E+00
         0.27039E+00    0.27049E+00
        -0.77191E+00   -0.77066E+00
         0.97100E+00    0.97123E+00
         0.30279E+00    0.30386E+00
        -0.11600E+01   -0.11604E+01
        -0.77332E+00   -0.77359E+00
         0.29568E+00    0.29578E+00
        -0.11827E+01   -0.11831E+01
         0.15080E+01    0.15085E+01
         0.50265E+00    0.50283E+00
        -0.13077E+00   -0.13063E+00
        -0.87431E-01   -0.88020E-01
         0.30122E-01    0.30298E-01
        -0.13535E+00   -0.13475E+00
         0.17888E+00    0.17820E+00
         0.64232E-01    0.64093E-01
        -0.19139E+00   -0.19110E+00
        -0.10936E+00   -0.10920E+00
         0.27341E-01    0.27301E-01
        -0.21873E+00   -0.21841E+00
         0.30641E+00    0.30596E+00
         0.12256E+00    0.12238E+00

EOF

diff -q test.out test.out.ref

exit $?

